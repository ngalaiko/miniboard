name: miniboard-backend
region: ams

domains:
- domain: api.miniboard.app
  type: PRIMARY

services:
- name: backend
  http_port: 80
  instance_count: 1
  instance_size_slug: basic-xxs
  environment_slug: go
  github:
    repo: ngalaiko/miniboard
    branch: master
  source_dir: backend
  envs:
  - key: MINIBOARD_CORS_DOMAINS
    scope: RUN_TIME
    value: "https://miniboard.app,https://docs.miniboard.app"
  - key: MINIBOARD_DB_DRIVER
    scope: RUN_TIME
    value: sqlite3
  - key: MINIBOARD_DB_ADDR
    scope: RUN_TIME
    value: "./db.sqlite3?_cache_size=128000&cache=shared"
  - key: MINIBOARD_DB_MAX_OPEN_CONNECTIONS
    scope: RUN_TIME
    value: "1"
  - key: MINIBOARD_AUTHORIZATIONS_DOMAIN
    scope: RUN_TIME
    value: "api.miniboard.app"
  - key: MINIBOARD_AUTHORIZATIONS_SECURE
    scope: RUN_TIME
    value: "true"
  - key: MINIBOARD_AUTHORIZATIONS_COOKIE_LIFETIME
    scope: RUN_TIME
    value: "720h"
  routes:
  - path: /
